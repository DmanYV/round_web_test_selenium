{"uid":"9b53af0bfac99e29","name":"Проверка восстановления пароля через email","fullName":"tests.test_reset_password.TestResetPassword#test_password_recovery_by_email","historyId":"b7700ec49977e2da21fba9d385aed2da","time":{"start":1721942926205,"stop":1721942934569,"duration":8364},"description":"Для восстановления используется email от Aleska","descriptionHtml":"<p>Для восстановления используется email от Aleska</p>\n","status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb75d0e4ef0>\nelements = {'Банк ачивок': {'Блок ачивок': ('xpath', '//div[contains(@class,\"user-achievement-by-interests_container\")]'), 'Модал...'.//button[@class=\"header_back__yUNba\"]'), 'Кнопка кэррот': ('xpath', '//div[@class=\"header_info__CHSYI\"]'), ...}, ...}\n\n    @allure.title('Проверка восстановления пароля через email')\n    @allure.description('Для восстановления используется email от Aleska')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_password_recovery_by_email(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести номер телефона от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.EMAIL)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase'):\n>           email_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:208: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...353094932, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1721942567862,"stop":1721942567882,"duration":20},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"driver","time":{"start":1721942925773,"stop":1721942926204,"duration":431},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup","time":{"start":1721942926204,"stop":1721942926205,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"elements","time":{"start":1721942926205,"stop":1721942926205,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Для восстановления используется email от Aleska","status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb75d0e4ef0>\nelements = {'Банк ачивок': {'Блок ачивок': ('xpath', '//div[contains(@class,\"user-achievement-by-interests_container\")]'), 'Модал...'.//button[@class=\"header_back__yUNba\"]'), 'Кнопка кэррот': ('xpath', '//div[@class=\"header_info__CHSYI\"]'), ...}, ...}\n\n    @allure.title('Проверка восстановления пароля через email')\n    @allure.description('Для восстановления используется email от Aleska')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_password_recovery_by_email(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести номер телефона от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.EMAIL)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase'):\n>           email_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:208: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...353094932, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","steps":[{"name":"Открыть страницу логина","time":{"start":1721942926205,"stop":1721942928385,"duration":2180},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Нажать кнопку забыл пароль","time":{"start":1721942928385,"stop":1721942929941,"duration":1556},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"В поле \"Email или номер телефона\" ввести номер телефона от Aleska","time":{"start":1721942929941,"stop":1721942931526,"duration":1585},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Нажать кнопку \"Сбросить пароль\"","time":{"start":1721942931526,"stop":1721942931568,"duration":42},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Авторизоваться в MetaBase","time":{"start":1721942931568,"stop":1721942932663,"duration":1095},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Найти последний код в MetaBase","time":{"start":1721942932663,"stop":1721942934568,"duration":1905},"status":"broken","statusMessage":"IndexError: list index out of range\n","statusTrace":"  File \"/usr/workspace/tests/test_reset_password.py\", line 208, in test_password_recovery_by_email\n    email_code = self.metabase.take_last_code(metabase)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/workspace/model/api/metabase.py\", line 53, in take_last_code\n    last_code = response.json()['data']['rows'][0][7]\n                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":0,"stepsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":0,"stepsCount":6,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"driver::0","time":{"start":1721942934576,"stop":1721942934774,"duration":198},"status":"passed","steps":[],"attachments":[{"uid":"42cb75ee39f931dd","name":"page_source","source":"42cb75ee39f931dd.html","type":"text/html","size":18845},{"uid":"1caa9d478a15019","name":"screenshot","source":"1caa9d478a15019.png","type":"image/png","size":41806},{"uid":"728a5d3ca91b7ced","name":"browser_logs","source":"728a5d3ca91b7ced.txt","type":"text/plain","size":2230}],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":3,"stepsCount":0,"hasContent":true,"attachmentStep":false}],"labels":[{"name":"feature","value":"Восстановление пароля"},{"name":"severity","value":"Critical"},{"name":"tag","value":"regression"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_reset_password"},{"name":"subSuite","value":"TestResetPassword"},{"name":"host","value":"154a2dd0ae07"},{"name":"thread","value":"1-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_reset_password"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":3,"skipped":0,"passed":4,"unknown":0,"total":7},"items":[{"uid":"a2990345ca7da7f0","status":"passed","time":{"start":1721851063302,"stop":1721851075245,"duration":11943}},{"uid":"34fe9701abf7d5e3","status":"broken","statusDetails":"IndexError: list index out of range","time":{"start":1721683402926,"stop":1721683411298,"duration":8372}},{"uid":"3bd50d5f8e1b1815","status":"passed","time":{"start":1721672005694,"stop":1721672018377,"duration":12683}},{"uid":"1596359335f6d76a","status":"passed","time":{"start":1721668842857,"stop":1721668855560,"duration":12703}},{"uid":"26dde1f8fbc46803","status":"passed","time":{"start":1720803064078,"stop":1720803077801,"duration":13723}},{"uid":"b70a5b97bc4086a0","status":"broken","statusDetails":"selenium.common.exceptions.TimeoutException: Message: Не найден элемент с локатором ('xpath', '//input[@name=\"code\"]')","time":{"start":1720800758397,"stop":1720800796190,"duration":37793}}]},"tags":["regression"]},"source":"9b53af0bfac99e29.json","parameterValues":[]}