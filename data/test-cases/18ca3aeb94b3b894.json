{"uid":"18ca3aeb94b3b894","name":"Проверка восстановления пароля по номеру телефона","fullName":"tests.test_reset_password.TestResetPassword#test_password_recovery_by_phone","historyId":"04757ce0114f1fb79d2fdcf8ea5506d5","time":{"start":1721942891895,"stop":1721942900387,"duration":8492},"description":"Для восстановления используется номер от Aleska","descriptionHtml":"<p>Для восстановления используется номер от Aleska</p>\n","status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb75d0e6ae0>\nelements = {'Банк ачивок': {'Блок ачивок': ('xpath', '//div[contains(@class,\"user-achievement-by-interests_container\")]'), 'Модал...'.//button[@class=\"header_back__yUNba\"]'), 'Кнопка кэррот': ('xpath', '//div[@class=\"header_info__CHSYI\"]'), ...}, ...}\n\n    @allure.title('Проверка восстановления пароля по номеру телефона')\n    @allure.description('Для восстановления используется номер от Aleska')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_password_recovery_by_phone(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести номер телефона от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.PHONE)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase'):\n>           sms_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:54: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...353094898, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1721942567862,"stop":1721942567882,"duration":20},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"driver","time":{"start":1721942891458,"stop":1721942891894,"duration":436},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup","time":{"start":1721942891894,"stop":1721942891895,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"elements","time":{"start":1721942891895,"stop":1721942891895,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Для восстановления используется номер от Aleska","status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb75d0e6ae0>\nelements = {'Банк ачивок': {'Блок ачивок': ('xpath', '//div[contains(@class,\"user-achievement-by-interests_container\")]'), 'Модал...'.//button[@class=\"header_back__yUNba\"]'), 'Кнопка кэррот': ('xpath', '//div[@class=\"header_info__CHSYI\"]'), ...}, ...}\n\n    @allure.title('Проверка восстановления пароля по номеру телефона')\n    @allure.description('Для восстановления используется номер от Aleska')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_password_recovery_by_phone(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести номер телефона от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.PHONE)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase'):\n>           sms_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:54: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...353094898, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","steps":[{"name":"Открыть страницу логина","time":{"start":1721942891895,"stop":1721942894604,"duration":2709},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Нажать кнопку забыл пароль","time":{"start":1721942894604,"stop":1721942896162,"duration":1558},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"В поле \"Email или номер телефона\" ввести номер телефона от Aleska","time":{"start":1721942896162,"stop":1721942897737,"duration":1575},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Нажать кнопку \"Сбросить пароль\"","time":{"start":1721942897737,"stop":1721942897779,"duration":42},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Авторизоваться в MetaBase","time":{"start":1721942897779,"stop":1721942898451,"duration":672},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":0,"stepsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Найти последний код в MetaBase","time":{"start":1721942898451,"stop":1721942900386,"duration":1935},"status":"broken","statusMessage":"IndexError: list index out of range\n","statusTrace":"  File \"/usr/workspace/tests/test_reset_password.py\", line 54, in test_password_recovery_by_phone\n    sms_code = self.metabase.take_last_code(metabase)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/workspace/model/api/metabase.py\", line 53, in take_last_code\n    last_code = response.json()['data']['rows'][0][7]\n                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":0,"stepsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"attachmentsCount":0,"stepsCount":6,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"driver::0","time":{"start":1721942900394,"stop":1721942900592,"duration":198},"status":"passed","steps":[],"attachments":[{"uid":"36799430790d2216","name":"page_source","source":"36799430790d2216.html","type":"text/html","size":18828},{"uid":"22246e2b091af78b","name":"screenshot","source":"22246e2b091af78b.png","type":"image/png","size":39505},{"uid":"110386403b1b8419","name":"browser_logs","source":"110386403b1b8419.txt","type":"text/plain","size":2230}],"parameters":[],"shouldDisplayMessage":false,"attachmentsCount":3,"stepsCount":0,"hasContent":true,"attachmentStep":false}],"labels":[{"name":"feature","value":"Восстановление пароля"},{"name":"severity","value":"Critical"},{"name":"tag","value":"regression"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_reset_password"},{"name":"subSuite","value":"TestResetPassword"},{"name":"host","value":"154a2dd0ae07"},{"name":"thread","value":"1-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_reset_password"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":6,"unknown":0,"total":8},"items":[{"uid":"485fbea24d32b9f","status":"passed","time":{"start":1721851027753,"stop":1721851039795,"duration":12042}},{"uid":"c62ac28376475c92","status":"broken","statusDetails":"IndexError: list index out of range","time":{"start":1721683366675,"stop":1721683375374,"duration":8699}},{"uid":"77ea0a42e80f1c76","status":"passed","time":{"start":1721671968110,"stop":1721671980826,"duration":12716}},{"uid":"3e7b44b728f81f8f","status":"passed","time":{"start":1721668806050,"stop":1721668818792,"duration":12742}},{"uid":"379db930d0a6ca61","status":"passed","time":{"start":1720803021786,"stop":1720803037013,"duration":15227}},{"uid":"7d7647c7bfd34d04","status":"passed","time":{"start":1720800721985,"stop":1720800734156,"duration":12171}},{"uid":"bbf1a918c69d7905","status":"passed","time":{"start":1720730384086,"stop":1720730396627,"duration":12541}}]},"tags":["regression"]},"source":"18ca3aeb94b3b894.json","parameterValues":[]}