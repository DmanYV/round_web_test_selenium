{"uid":"303c48a3a20a09c8","name":"Проверка возможности повторно запросить email код","fullName":"tests.test_reset_password.TestResetPassword#test_opportunity_to_re_request_email_code","historyId":"064bf015952483adf96ed75e297906d3","time":{"start":1721683421336,"stop":1721683429707,"duration":8371},"status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb3f872a150>\nelements = {'Панель навигации': {'Кнопка главная': ('xpath', '//a[@href=\"/\"]'), 'Кнопка лента': ('xpath', '//a[@href=\"/feed\"]'), ..., 'Кнопка запросить код еще раз': ('xpath', '//button[@class=\"button_content__7wfbm button_light__j7a6Y\"]'), ...}, ...}\n\n    @allure.title('Проверка возможности повторно запросить email код')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_opportunity_to_re_request_email_code(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести email от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.EMAIL)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase и проверить, что он пришел'):\n>           first_email_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:287: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...352835427, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","flaky":true,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1721683115880,"stop":1721683115901,"duration":21},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"driver","time":{"start":1721683420909,"stop":1721683421336,"duration":427},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"elements","time":{"start":1721683421336,"stop":1721683421336,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"setup","time":{"start":1721683421336,"stop":1721683421336,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0}],"testStage":{"status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb3f872a150>\nelements = {'Панель навигации': {'Кнопка главная': ('xpath', '//a[@href=\"/\"]'), 'Кнопка лента': ('xpath', '//a[@href=\"/feed\"]'), ..., 'Кнопка запросить код еще раз': ('xpath', '//button[@class=\"button_content__7wfbm button_light__j7a6Y\"]'), ...}, ...}\n\n    @allure.title('Проверка возможности повторно запросить email код')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_opportunity_to_re_request_email_code(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести email от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.EMAIL)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase и проверить, что он пришел'):\n>           first_email_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:287: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...352835427, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","steps":[{"name":"Открыть страницу логина","time":{"start":1721683421336,"stop":1721683423832,"duration":2496},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Нажать кнопку забыл пароль","time":{"start":1721683423832,"stop":1721683425387,"duration":1555},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"В поле \"Email или номер телефона\" ввести email от Aleska","time":{"start":1721683425387,"stop":1721683426973,"duration":1586},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Нажать кнопку \"Сбросить пароль\"","time":{"start":1721683426973,"stop":1721683427015,"duration":42},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Авторизоваться в MetaBase","time":{"start":1721683427015,"stop":1721683427882,"duration":867},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Найти последний код в MetaBase и проверить, что он пришел","time":{"start":1721683427882,"stop":1721683429707,"duration":1825},"status":"broken","statusMessage":"IndexError: list index out of range\n","statusTrace":"  File \"/usr/workspace/tests/test_reset_password.py\", line 287, in test_opportunity_to_re_request_email_code\n    first_email_code = self.metabase.take_last_code(metabase)\n                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/workspace/model/api/metabase.py\", line 53, in take_last_code\n    last_code = response.json()['data']['rows'][0][7]\n                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"hasContent":true,"attachmentStep":false,"attachmentsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":6,"hasContent":true,"attachmentStep":false,"attachmentsCount":0},"afterStages":[{"name":"driver::0","time":{"start":1721683429715,"stop":1721683429906,"duration":191},"status":"passed","steps":[],"attachments":[{"uid":"47779f960c70d57b","name":"page_source","source":"47779f960c70d57b.html","type":"text/html","size":18845},{"uid":"e90a5cd47fa68b89","name":"screenshot","source":"e90a5cd47fa68b89.png","type":"image/png","size":42015},{"uid":"5fee4a2c1b2ec1d7","name":"browser_logs","source":"5fee4a2c1b2ec1d7.txt","type":"text/plain","size":2230}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":true,"attachmentStep":false,"attachmentsCount":3}],"labels":[{"name":"severity","value":"Critical"},{"name":"feature","value":"Восстановление пароля"},{"name":"tag","value":"regression"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_reset_password"},{"name":"subSuite","value":"TestResetPassword"},{"name":"host","value":"09567fd04e0a"},{"name":"thread","value":"1-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_reset_password"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":1,"broken":3,"skipped":0,"passed":1,"unknown":0,"total":5},"items":[{"uid":"9d381b57c2fa9dc0","status":"broken","statusDetails":"selenium.common.exceptions.TimeoutException: Message: Не найден элемент с локатором ('xpath', '//button[@class=\"button_content__7wfbm button_light__j7a6Y\"]')","time":{"start":1721672027358,"stop":1721672130010,"duration":102652}},{"uid":"6005bfea2a802b41","status":"passed","time":{"start":1721668864480,"stop":1721668938795,"duration":74315}},{"uid":"7bb37f24c2034bdd","status":"failed","statusDetails":"AssertionError: assert '9617' != '9617'","time":{"start":1720803088203,"stop":1720803165134,"duration":76931}},{"uid":"c05d36c4256fbdb9","status":"broken","statusDetails":"selenium.common.exceptions.TimeoutException: Message: Не найден элемент с локатором ('xpath', '//button[@class=\"button_content__7wfbm button_light__j7a6Y\"]')","time":{"start":1720800805819,"stop":1720800909369,"duration":103550}}]},"tags":["regression"]},"source":"303c48a3a20a09c8.json","parameterValues":[]}