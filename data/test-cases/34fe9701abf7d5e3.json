{"uid":"34fe9701abf7d5e3","name":"Проверка восстановления пароля через email","fullName":"tests.test_reset_password.TestResetPassword#test_password_recovery_by_email","historyId":"b7700ec49977e2da21fba9d385aed2da","time":{"start":1721683402926,"stop":1721683411298,"duration":8372},"description":"Для восстановления используется email от Aleska","descriptionHtml":"<p>Для восстановления используется email от Aleska</p>\n","status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb3f8729880>\nelements = {'Панель навигации': {'Кнопка главная': ('xpath', '//a[@href=\"/\"]'), 'Кнопка лента': ('xpath', '//a[@href=\"/feed\"]'), ..., 'Кнопка запросить код еще раз': ('xpath', '//button[@class=\"button_content__7wfbm button_light__j7a6Y\"]'), ...}, ...}\n\n    @allure.title('Проверка восстановления пароля через email')\n    @allure.description('Для восстановления используется email от Aleska')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_password_recovery_by_email(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести номер телефона от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.EMAIL)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase'):\n>           email_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:208: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...352835409, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1721683115880,"stop":1721683115901,"duration":21},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"driver","time":{"start":1721683402491,"stop":1721683402925,"duration":434},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"setup","time":{"start":1721683402925,"stop":1721683402925,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"elements","time":{"start":1721683402925,"stop":1721683402925,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0}],"testStage":{"description":"Для восстановления используется email от Aleska","status":"broken","statusMessage":"IndexError: list index out of range","statusTrace":"self = <test_reset_password.TestResetPassword object at 0x7fb3f8729880>\nelements = {'Панель навигации': {'Кнопка главная': ('xpath', '//a[@href=\"/\"]'), 'Кнопка лента': ('xpath', '//a[@href=\"/feed\"]'), ..., 'Кнопка запросить код еще раз': ('xpath', '//button[@class=\"button_content__7wfbm button_light__j7a6Y\"]'), ...}, ...}\n\n    @allure.title('Проверка восстановления пароля через email')\n    @allure.description('Для восстановления используется email от Aleska')\n    @allure.severity('Critical')\n    @pytest.mark.regression\n    def test_password_recovery_by_email(self, elements):\n        with allure.step('Открыть страницу логина'):\n            self.login_page.open()\n            element = elements['Страница логина']\n    \n        with allure.step('Нажать кнопку забыл пароль'):\n            self.login_page.do_click(element['Кнопка забыл пароль'])\n    \n        with allure.step('В поле \"Email или номер телефона\" ввести номер телефона от Aleska'):\n            element = elements['Страница восстановления пароля']\n            self.reset_password_page.field_send_keys(element['Поле логин'],\n                                                     text=self.User.EMAIL)\n    \n        with allure.step('Нажать кнопку \"Сбросить пароль\"'):\n            self.reset_password_page.do_click(element['Кнопка сбросить пароль'])\n    \n        with allure.step('Авторизоваться в MetaBase'):\n            metabase = self.metabase.authorization(username=self.MetaBaseUser.LOGIN,\n                                                   password=self.MetaBaseUser.PASSWORD)\n    \n        with allure.step('Найти последний код в MetaBase'):\n>           email_code = self.metabase.take_last_code(metabase)\n\ntests/test_reset_password.py:208: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncookies = <RequestsCookieJar[Cookie(version=0, name='metabase.TIMEOUT', value='alive', port=None, port_specified=False, domain='...352835409, discard=False, comment=None, comment_url=None, rest={'HttpOnly': None, 'SameSite': 'None'}, rfc2109=False)]>\n\n    @staticmethod\n    def take_last_code(cookies: RequestsCookieJar) -> str:\n        \"\"\"\n        Метод получения Session_ID в Metabase через API.\n    \n        :param cookies: Куки авторизации\n        :return: last_code: Последний созданный код в таблице\n        \"\"\"\n        cookies = cookies\n        json = {\"type\": \"query\",\n                \"query\": {\"source-table\": 121,\n                          \"filter\": [\"time-interval\",\n                                     [\"field\", 726, None],\n                                     \"current\",\n                                     \"day\",\n                                     {\"include_current\": True}],\n                          \"order-by\": [[\"desc\", [\"field\", 728, None]]]},\n                \"database\": 5,\n                \"parameters\": []}\n        time.sleep(1)\n        response = requests.post(url=MetaBaseLinks.DATA_SATE, cookies=cookies, json=json)\n>       last_code = response.json()['data']['rows'][0][7]\nE       IndexError: list index out of range\n\nmodel/api/metabase.py:53: IndexError","steps":[{"name":"Открыть страницу логина","time":{"start":1721683402926,"stop":1721683405411,"duration":2485},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Нажать кнопку забыл пароль","time":{"start":1721683405411,"stop":1721683406966,"duration":1555},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"В поле \"Email или номер телефона\" ввести номер телефона от Aleska","time":{"start":1721683406966,"stop":1721683408552,"duration":1586},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Нажать кнопку \"Сбросить пароль\"","time":{"start":1721683408552,"stop":1721683408593,"duration":41},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Авторизоваться в MetaBase","time":{"start":1721683408594,"stop":1721683409456,"duration":862},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":false,"attachmentStep":false,"attachmentsCount":0},{"name":"Найти последний код в MetaBase","time":{"start":1721683409456,"stop":1721683411297,"duration":1841},"status":"broken","statusMessage":"IndexError: list index out of range\n","statusTrace":"  File \"/usr/workspace/tests/test_reset_password.py\", line 208, in test_password_recovery_by_email\n    email_code = self.metabase.take_last_code(metabase)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/workspace/model/api/metabase.py\", line 53, in take_last_code\n    last_code = response.json()['data']['rows'][0][7]\n                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"hasContent":true,"attachmentStep":false,"attachmentsCount":0}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":6,"hasContent":true,"attachmentStep":false,"attachmentsCount":0},"afterStages":[{"name":"driver::0","time":{"start":1721683411305,"stop":1721683411490,"duration":185},"status":"passed","steps":[],"attachments":[{"uid":"956ab7f4e085553c","name":"page_source","source":"956ab7f4e085553c.html","type":"text/html","size":18845},{"uid":"c4ea26ac0f108847","name":"screenshot","source":"c4ea26ac0f108847.png","type":"image/png","size":42015},{"uid":"4b6361f398505a94","name":"browser_logs","source":"4b6361f398505a94.txt","type":"text/plain","size":2230}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"hasContent":true,"attachmentStep":false,"attachmentsCount":3}],"labels":[{"name":"severity","value":"Critical"},{"name":"feature","value":"Восстановление пароля"},{"name":"tag","value":"regression"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_reset_password"},{"name":"subSuite","value":"TestResetPassword"},{"name":"host","value":"09567fd04e0a"},{"name":"thread","value":"1-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_reset_password"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"critical","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":2,"skipped":0,"passed":3,"unknown":0,"total":5},"items":[{"uid":"3bd50d5f8e1b1815","status":"passed","time":{"start":1721672005694,"stop":1721672018377,"duration":12683}},{"uid":"1596359335f6d76a","status":"passed","time":{"start":1721668842857,"stop":1721668855560,"duration":12703}},{"uid":"26dde1f8fbc46803","status":"passed","time":{"start":1720803064078,"stop":1720803077801,"duration":13723}},{"uid":"b70a5b97bc4086a0","status":"broken","statusDetails":"selenium.common.exceptions.TimeoutException: Message: Не найден элемент с локатором ('xpath', '//input[@name=\"code\"]')","time":{"start":1720800758397,"stop":1720800796190,"duration":37793}}]},"tags":["regression"]},"source":"34fe9701abf7d5e3.json","parameterValues":[]}